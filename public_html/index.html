<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link  rel="stylesheet" href="../stylesheets/style.css"></link>
	<title>3on3 Ping Calculator</title>
	


	<meta name="description" content="3on3 Freestyle Ping Calculator: Calculates 3on3 Freestyle Ping since it is not included in the game." />
	<meta property="og:title" content="3on3 Ping Calculator: Helping you Get The Rebound" />
	<meta property="og:url" content="http://3on3ping.com/" />
	<meta property="og:image" content="http://3on3ping.com/wtfyl.jpg" />
	<meta property="og:type" content="article" />
	<meta property="og:description" content="This is a simple tool to let you know your ping and how it measures up against others." />

</head>
<body>
    
    <!-- header showcase -->
    <header id="showcase" class="grid">
        <div class="bg-image"></div>
        <div class="content-wrap">
        <h1>3on3 Ping Calculator</h1>
        <p>A thank you to <span style="color:#3cb371"> YuZ </span> and <span style="color:#3cb371"> Jeremy</span> for the donations, also a quick thank you to <span style="color:#3cb371"> Fret </span> some upcoming changes I shouldve already implemented -  Alienfunbug[LMIW]
        </p>

	<!-- temporarily removing auto
		<a href="#section-b"  class="btn" id="startButton"> Auto All</a>
	-->
        <ul id=btns>
            <li><a href="#section-b" class="btn" id="startWest">Ping West</a></li>
            <li><a href="#section-b" class="btn", id="startEast">Ping East</a></li>
			<li><a href="#section-b" class="btn", id="startEurope">Ping West</a></li>
			<li><a href="#section-b" class="btn", id="startAsia">Ping Asia</a></li>
        </ul>
    </div>
    </header>

    <p id="currentLocalTimeA"></p>
    <!-- initial result table -->
    <div class="card">
	<table id="pingTable" >
		<tr>
			<th>Server</th>
			<th>Latency</th>
			<th>Rating</th>
		</tr>
		
		<tr><!--USEAST-->
			<td><span class ="strongText">US East</span></td>
			<td class ="latency"  id="eastLatency" 
			server="http://dynamodb.us-east-1.amazonaws.com/">Latency</td>
			<td id="eastLatency1" >Rating</td>
		</tr>
		
		<tr><!--USWEST-->
			<td><span class ="strongText">US West</span></td>
			<td class = "latency"  id="westLatency"
			server="http://dynamodb.us-west-1.amazonaws.com/">Latency</td>
			<!--http://dynamodb.us-west-2.amazonaws.com/-->
			<td id="westLatency1" >Rating</td>
		</tr>
		
		<tr><!--ASIA2-->
			<td><span class ="strongText">Asia 2</span></td>
			<td class = "latency"  id="asiaLatency"
			server="http://dynamodb.ap-northeast-1.amazonaws.com/">Latency</td>
			<td id="asiaLatency1" >Rating</td>
		</tr>
		
		<tr><!--EUROPE-->
			<td><span class ="strongText">Europe</span></td>
			<td class = "latency" id="euLatency"
			server="http://dynamodb.eu-central-1.amazonaws.com/">Latency</td>
			<td id="euLatency1" >Rating</td>
			<td id='imageCell'></td>
		</tr>
    </table>
</div>
 
    

    <!-- main showcase -->
    <main id="main">
        <!-- section a -->
        <section id="section-a" class="grid">
            <div class="content-wrap">
                <h2 class="content-title">New Ping Site Changes</h2>
                <p>I've received a lot of inquiry about latency fluctuating (natural) as well as details on people who could be fabricating about their ping. Hopefully the new graph feature and time stamps can help users deal with both of these issues. Additionally, if you don't like the new changes, the old websites are still up and running at <a href="http://3on3ping.com/version1">3on3ping.com/version1</a> and <a href="http://3on3ping.com/version2">3on3ping.com/version2</a> Enjoy!</p>
                <br>
            </div>
        </section>

        <!-- section b -->
        <section id="section-b" class="grid">
        <ul>
            <li>
                <div class="card">
                  
                   
                    <div class="card-content">
                    <h3 class="card-title" id="homeServer"> Pinging Closest Server:  <span id = "homeServerDetail" span style="color:#3cb371" > </span> </h3>
                    <p>This chart navigates to the lowest ping response server. Ping responses are displayed over approximately a ten second period for a more accurate depiction of your latency. If you feel that it pulled the wrong server in error, please rerun the ping test.</p>
                    <p id="currentLocalTimeB"></p>
                    <div class="card">
                    <canvas id="myChart"></canvas>
                    </div>
                    <h3 id="minPing" >Mininum Ping: <span id="minPingResult" span style="color:#3cb371" ></span></h3>
                
                    
                    </div>
                </div>
            </li>



        </ul>
    </section>


    <section id="section-c" class="grid">
        <div class="content-wrap">
            <h2 class="content-title"> Ping Warrior Action BB</h2>
            <p>
                It wouldn't be right to have this website online without having at least one ridiculous 3on3 image. Thanks to DJMA the ping lord, enjoy this photo of Christa Getting Snagged On by Kim. Max clearly wanted no part of this action.
     
                    <h3 class="card-title"> Kim  vs. Christa</h3>
                    <img src="../images/pingSnag.jpg" alt="">
                    <div class="card-content">

            </p>
        </div>

    </section>

    <section id="section-d" class="grid">
        <div class="box">
            <h2 class="content-title">Contact Me</h2>
            <p>If you have any questions or concerns, feel free to contact me at <a href= "mailto:alienfunbug@gmail.com"> alienfunbug@gmail.com</a> or via PSN at letsmakeitweird (though I no longer even play PS4).  If you'd like to help keep the site alive through donations. Details and a donate button have been added below</p>
  
        </div>  
        <div class="box">
            <h2 class="content-title">About This Website</h2>
            <p>October 10th 2020, this website will be shutting down. I've spent significantly more hosting and paying for the site over the years than I've spent playing all playstation games combined. If you'd like to donate to help prevent that, the link is down below. All donations will go directly to the hosting fees, and will extend the duration of me keeping the site up.  Thanks everyone for stopping by.</p>
          
            <br>


			

				<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_donations" />
					<input type="hidden" name="business" value="NYPG2Q9K86VG4" />
					<input type="hidden" name="item_name" value="Website Funding" />
					<input type="hidden" name="currency_code" value="USD" />
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
				
					</form>
					
			
				
        </div>
        <br>
   
            
    </section>
    <div class="box">

</div>        
    </main>
    

    <!-- footer -->
<footer id="main-footer" class="grid">

    
    <div> 3on3ping calculator</div>
    
    <div>By <a href="https://www.paypal.com/donate/?token=xmxIWRwv7lnD39xP5uCLg8H0vBXIrOH5Q019xDfHJ-JtXQ62Xq_nyUwM6_jMzNyX8IyKKW&country.x=US&locale.x=" target="_top"> Alienfunbug</a></div>
    
</footer>


<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script type="text/javascript" src="../dependancies/jquery-1.7.1.min.js"></script>

<script>
	

    

	var startButton = $("#startButton");
	var pingResponses = [];
	var pingDefaultResponses = [];
	var homeServer = "";
	var date = new Date();
	var lowestMeasuredPing = 9999;
	
	

	window.onload = function(){
	var currentTime = date.toLocaleString();
    document.getElementById("currentLocalTimeA").innerHTML = currentTime;
    document.getElementById("currentLocalTimeB").innerHTML = currentTime;
};



	//prevent spam pings
	function disableStartButton(){
		startButton.attr("disabled", "disabled");
	};

	// enable button
	function enableStartButton(){
		startButton.removeAttr("disabled");
	};
	
	//get start and end time
	function currentTimeMillis(){
		return (new Date()).getTime();
	};

	//credit to Mike Leonhard for image RTT technique
	function getServers(){
		disableStartButton();
		$("#eastLatency1").text("Cleared"); $("#eastLatency1").css("color", "Gray");
		$("#euLatency1").text("Cleared"); $("#euLatency1").css("color", "Gray");
		$("#westLatency1").text("Cleared"); $("#westLatency1").css("color", "Gray");
		$("#asiaLatency1").text("Cleared"); $("#asiaLatency1").css("color", "Gray");
		var serverInfo = $(".latency").toArray();
		serverInfo.reverse();
		loadNextServer(serverInfo);
	};

	function findLowestRegion(pingArray){	
		var index = pingArray.indexOf(Math.min(...pingArray));
			//console.log(index);
			switch(index){
				case 0: 
					homeServer = "USEast";
					break;
				case 1: 
					homeServer = "USWest";
					break;	
				case 2: 
					homeServer = "Asia 2";
					break;
				case 3: 
					homeServer = "Europe";
					break;
			}
			//console.log(homeServer);	
			document.getElementById('homeServerDetail').innerHTML =  homeServer;
	};
	
	function loadNextServer(serverInfo){
		var next = serverInfo.pop();
		if(next){
			var region = next.id;
			var url = next.getAttribute("server");
			connecting(next, region, url, serverInfo);
		} else {
			findLowestRegion(pingResponses);
			loadDefaultServer(homeServer);
			//console.log(pingResponses);
			//  responses here
			
			//console.log(typeof pingResponses);
			//console.log(typeof pingResponses[0]);
			//console.log(pingDefaultResponses);
			//update chart and graph
			pingResponses = [];
            lowestMeasuredPing = 9999;
			enableStartButton();
		}
	};
	
	function connecting(next, region, url, serverInfo) {
		$(next).html("connecting");
			pingServers(next, region, url, serverInfo);
	};

	function pingServers(next, region, url, serverInfo){
		$(next).html("pinging");
		var startTime = currentTimeMillis();
		ping_endpoint(url, function(){
			finishPing(startTime, next, region, url, serverInfo);
		});
	};

	function finishPing(startTime, next, region, url, serverInfo){
		var endTime = currentTimeMillis();
		var RTT = endTime - startTime;
		pingResponses.push(RTT);
		var RTToutput = "" + RTT + " ms";
		$(next).html(RTToutput);
		var rating = region+"1";	
		$('#'+rating).html(ratePing(RTT,rating));
		//document.getElementById("demo").innerHTML = ratePing(RTT);
		loadNextServer(serverInfo);
	};
	
	
	function ratePing(RTT,rating){
		if (RTT < 40){
			$('#'+rating).css("color", "#00FF00", "font-weight","bold");
			$('#'+rating).css("font-weight", "bold");
			return "EXCELLENT";
		} else if (RTT < 56){
			$('#'+rating).css("color", "#90EE90", "font-weight","bold");
			$('#'+rating).css("font-weight", "bold");
			return "GOOD";
		} else if (RTT < 100){
			$('#'+rating).css("color", "#FF8C00", "font-weight","bold");
			$('#'+rating).css("font-weight", "bold");
			return "FAIR";
		} else {
			$('#'+rating).css("color", "#FF4500");
			$('#'+rating).css("font-weight", "bold");
			return "POOR";
		}
	}

	
	var imageCell = $("#imageCell")
	function ping_endpoint(url, onComplete) {
	    var randomString = Math.floor(Math.random()*0xFFFFFFFFFFFFFFFF).toString(36);
	    var targetUrl = url + "ping?x=" + randomString;
	    imageCell.empty();
	    imageCell.html("<img id='pingImage' style='display: none'>");
	    var pingImage = $("#pingImage");
	    pingImage.error(onComplete);
	    pingImage.attr("src", targetUrl);
	}
	
	$(document).ready(function(){


		$("#startButton").click(function(e){
            var linkHref = $(this).attr("href");
     
            e.preventDefault();
            getServers();

            setTimeout(
            function() {
                $("html, body").animate({
                scrollTop: $(linkHref).offset().top
            }, 2000);
            },
            1000);
	     
         });
	});
	


//chart scripts for specific servers

function loadDefaultServer(defaultServer) {
	
	//console.log("enter switch statement and the DEFAULT SERVER IS" + defaultServer.toString() );
	//console.log(defaultServer);
	//console.log(typeof(defaultServer));
	var url = "";
	switch(defaultServer){
		
				case "USEast": 
					url = "http://dynamodb.us-east-1.amazonaws.com/";
					//console.log("set URL TO  EAST")
					break;
				case "USWest": 
					url = "http://dynamodb.us-west-1.amazonaws.com/";
					//console.log("set URL TO  WEST")
					break;	
				case "Asia 2": 
					url = "http://dynamodb.ap-northeast-1.amazonaws.com/";
					//console.log("set URL TO  ASIA")
					break;
				case "Europe": 
					url = "http://dynamodb.eu-central-1.amazonaws.com/";
					//console.log("set URL TO  EU")
					break;
			}

			//console.log(typeof(url));
			//console.log(url);
	var pingCount;
	for (pingCount = 0; pingCount <= 9; pingCount++){
		setTimeout(function() { 
			pingDefaultServer(url); updateChart(); }, 1250 * pingCount); 
	}
	pingDefaultResponses = [];

};

function pingDefaultServer(url) {
    var startTime = currentTimeMillis();
    ping_endpoint(url, function() {
        finishDefaultPing(startTime, url);
    });
};

function finishDefaultPing(startTime, url) {
    var endTime = currentTimeMillis();
    var RTT = endTime - startTime;
    pingDefaultResponses.push(RTT);

	
	if (RTT < lowestMeasuredPing){
		document.getElementById("minPingResult").innerHTML = RTT;
		lowestMeasuredPing = RTT;
	}
};


//start graphing
var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {

    // The type of chart we want to create
    type: 'line',
    // The data for our dataset
    data: {
        labels: ['ping 0','ping 1','ping 2','ping 3','ping 4', 'ping 5', 'ping 6', 'ping 7', 'ping 8', 'ping 9'],
        datasets: [{
            label: 'Ping Results',
            backgroundColor: '#fff',
            borderColor: '#eaeaea',
			fill: false,
            data: [],
        }]
    },
    // Configuration options go here
    options: {
		responsive: true,
              scales: {
                  yAxes: [{
                      scaleLabel: {
                          display: true,
                          labelString: 'Ping  (ms)',
                      }
                  }]
              }
	}
});

function updateChart() {
	chart.data.datasets[0].data = pingDefaultResponses;
	setTimeout(() => { chart.update(); }, 2000);
}

</script>	







</body>
</html>